# DS-ADX-ETH-MT5-Bot

Советник разработан для MetaTrader 5 по [этому](spec.md) техническому заданию.

# Установка
1. Убедитесь, что ваш терминал MetaTrader 5 обновлен до последней версии. Для тестирования ботов рекомендуется обновить терминал до самой последней бета-версии. Для этого запустите обновление из главного меню `Help->Check For Updates->Latest Beta Version`. На прошлых версиях бот может не запускаться, потому что скомпилирован на последней версии терминала. В этом случае вы увидите сообщения на вкладке `Journal` об этом.
2. Скопируйте исполняемый файл бота *.ex5 в каталог данных терминала `MQL5\Experts\`.
3. Откройте график пары.
4. Перетащите советника из окна Навигатор на график.
5. Установите в настройках бота галочку `Allow Auto Trading`.
6. Включите режим автоторговли в терминале, нажав кнопку `Algo Trading` на главной панели инструментов.


# Как работает бот
1. На каждом тике бот проверяет условия, при наступлении которых, он разместит пару отложенных STOP ордеров:
    - Значение ADX меньше установленного в настройке `1.ADX.TV`.
    - Еще нет размещенных ордеров или открытых позиций.
2. После срабатывания первого ордера бот закрывает второй.
3. Открытые позиции будут закрыты, если на любом тике будет выполнено условие:
    - достигнут фиксированный SL или TP, которые отслеживает и исполняет брокер;
    - если `H-O` текущей свечи станет больше, чем `(H-L)*2` прошлой свечи.
4. Также на каждом тике для каждой открытой позиции бот проверяет достигла ли цена установленного в `2.BE.D` уровня перевода в безубыток, после чего сдвигает SL в BE.

# Настройки

## 1. ENTRY TRADE

- `1.MM.L: Lot Size` - размер лота каждого открываемого ордера.
- `1.SLP: Max Slippage, point` - максимально допустимое проскальзывание торговых операций.
- `1.ADX.MAP: ADX MA Period, bars` - глубина периода MA для расчета ADX.
- `1.ADX.BS: Bar Shift to get Signal, bars (0-current bar)` - сдвиг на указанное количество свечей назад для расчета ADX. Если `0`, то в расчет включена текущая свеча. Если `1`, то расчет начинается с одной свечи назад, исключая текущую незакрытую свечу.
- `1.ADX.TV: Place Pending Orders when ADX < Value ` - пороговое значение индикатора ADX, ниже которого размещаются отложенные ордера.
- `1.EP.EP: Entry Price as HIGH/LOW of Period, bars` - глубина баров истории для поиска HIGH или LOW для определения цены размещения отложенного ордера.
- `1.EP.ETF Entry Price as HIGH/LOW on TF` - таймфрейм, на котором выполняется поиск HIGH или LOW для определения цены размещения отложенного ордера.

## 2. EXIT TRADE"
`2.SL.D: Stop Loss Distance, point` - дистанция SL в пунктах.
`2.TP.D: Take Profit Distance, point` - дистанция TP в пунктах.
`2.BE.D: Distance to Move SL to BE, point` - дистанция в направлении прибыли, после прохождения которой, SL перемещается в безубыток.

## 10. MISC
- `10.LL: Log Level` уровень логирования. `DEBUG` покажет на каждой свете все найденный точки паттерна, а также на каждом тике покажет статус по частичному закрытию позиции и переводу в безубыток, а также все сдвиги SL по TSL.
- `10.MGC: Magic` число мэджик. Рекомендуется применять для каждого запуска свой мэджик даже на разных парах.